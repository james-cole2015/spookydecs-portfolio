<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SpookyDecs — Items Management</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="modal-styles.css">
</head>
<body>

<header>
  <h1>SpookyDecs — Items Management</h1>
  <div style="flex:1"></div>
  <div id="authInfo" class="small muted">Admin User</div>
  <a id="adminLink" href="#" style="color:#0f172a;text-decoration:none;padding:8px 10px;background:white;border-radius:6px;font-size:14px;border:1px solid #ddd;">Admin</a>
  <button id="btnLogout" style="background:#2b2b2b;color:white;">Logout</button>
</header>

<!-- Season Stats -->
<div class="stats-section">
  <div class="stats-label">By Season</div>
  <div class="cards">
    <div class="card">
      <div class="card-value" id="stat-halloween">12</div>
      <div class="card-label">Halloween</div>
    </div>
    <div class="card">
      <div class="card-value" id="stat-christmas">8</div>
      <div class="card-label">Christmas</div>
    </div>
    <div class="card">
      <div class="card-value" id="stat-shared">5</div>
      <div class="card-label">Shared</div>
    </div>
  </div>
</div>

<!-- Class Stats -->
<div class="stats-section">
  <div class="stats-label">By Class</div>
  <div class="cards">
    <div class="card">
      <div class="card-value" id="stat-accessory">8</div>
      <div class="card-label">Accessory</div>
    </div>
    <div class="card">
      <div class="card-value" id="stat-decoration">12</div>
      <div class="card-label">Decoration</div>
    </div>
    <div class="card">
      <div class="card-value" id="stat-light-class">5</div>
      <div class="card-label">Light</div>
    </div>
  </div>
</div>

<!-- Controls -->
<div class="controls">
  <button class="btn-create" id="btnCreateItem">+ Create Item</button>
  <button class="btn-danger" id="btnDeleteItem">Delete Item</button>
  <div style="flex:1"></div>
  <input type="text" id="searchInput" placeholder="Search items..." style="min-width: 200px;">
</div>

<!-- Desktop Table View -->
<div class="table">
  <table id="itemsTable">
    <thead>
      <tr>
        <th>Status</th>
        <th>Name</th>
        <th>Season</th>
        <th>Class Type</th>
        <th>Repair Status</th>
        <th>Location</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody id="tableBody">
      <!-- Items will be populated by JavaScript -->
    </tbody>
  </table>
</div>

<!-- Mobile Card View -->
<div class="item-cards" id="itemCards">
  <!-- Cards will be populated by JavaScript -->
</div>

<!-- View Modal -->
<div id="viewModal" class="modal" style="display:none;">
  <div class="panel">
    <div class="modal-header">
      <h2 id="viewModalTitle">Item Details</h2>
      <button class="close-btn" onclick="closeModal('viewModal')">&times;</button>
    </div>
    
    <div class="view-item-id" id="viewItemId">ITEM-XXX-XXXX</div>
    
    <!-- Desktop Tabs -->
    <div class="tab-nav">
      <button class="tab-btn active" data-tab="details" onclick="switchViewTab('details')">Details</button>
      <button class="tab-btn" data-tab="vendor" onclick="switchViewTab('vendor')">Vendor</button>
      <button class="tab-btn" data-tab="repairs" onclick="switchViewTab('repairs')">Repairs</button>
      <button class="tab-btn" data-tab="deployments" onclick="switchViewTab('deployments')">Deployments</button>
      <button class="tab-btn" data-tab="storage" onclick="switchViewTab('storage')">Storage</button>
      <button class="tab-btn" data-tab="photos" onclick="switchViewTab('photos')">Photos</button>
      <button class="tab-btn" data-tab="misc" onclick="switchViewTab('misc')">Misc</button>
    </div>
    
    <!-- Mobile Dropdown -->
    <div class="tab-dropdown-container">
      <select class="tab-dropdown" id="viewTabDropdown" onchange="switchViewTab(this.value)">
        <option value="details">Details</option>
        <option value="vendor">Vendor</option>
        <option value="repairs">Repairs</option>
        <option value="deployments">Deployments</option>
        <option value="storage">Storage</option>
        <option value="photos">Photos</option>
        <option value="misc">Misc</option>
      </select>
    </div>
    
    <div class="modal-body">
      <div class="tab-content active" data-tab="details" id="viewDetailsContent"></div>
      <div class="tab-content" data-tab="vendor" id="viewVendorContent"></div>
      <div class="tab-content" data-tab="repairs" id="viewRepairsContent"></div>
      <div class="tab-content" data-tab="deployments" id="viewDeploymentsContent"></div>
      <div class="tab-content" data-tab="storage" id="viewStorageContent"></div>
      <div class="tab-content" data-tab="photos" id="viewPhotosContent"></div>
      <div class="tab-content" data-tab="misc" id="viewMiscContent"></div>
    </div>
    
    <div class="modal-footer">
      <button class="btn-secondary" onclick="editItemFromView()">Edit</button>
      <button class="btn-secondary" onclick="closeModal('viewModal')">Close</button>
    </div>
  </div>
</div>

<!-- Edit Modal -->
<div id="editModal" class="modal" style="display:none;">
  <div class="panel">
    <div class="modal-header">
      <h2 id="editModalTitle">Edit Item</h2>
      <button class="close-btn" onclick="closeModal('editModal')">&times;</button>
    </div>
    
    <div id="editFormView">
      <!-- Desktop Tabs -->
      <div class="tab-nav">
        <button class="tab-btn active" data-tab="details" onclick="switchEditTab('details')">Details</button>
        <button class="tab-btn" data-tab="vendor" onclick="switchEditTab('vendor')">Vendor</button>
        <button class="tab-btn" data-tab="storage" onclick="switchEditTab('storage')">Storage</button>
        <button class="tab-btn" data-tab="misc" onclick="switchEditTab('misc')">Misc</button>
      </div>
      
      <!-- Mobile Dropdown -->
      <div class="tab-dropdown-container">
        <select class="tab-dropdown" id="editTabDropdown" onchange="switchEditTab(this.value)">
          <option value="details">Details</option>
          <option value="vendor">Vendor</option>
          <option value="storage">Storage</option>
          <option value="misc">Misc</option>
        </select>
      </div>
      
      <div class="modal-body">
        <form id="editForm">
          <!-- Details Tab -->
          <div class="tab-content active" data-tab="details">
            <div class="form-group">
              <label for="edit-short-name">Name <span class="required">*</span></label>
              <input type="text" id="edit-short-name" required>
            </div>
            
            <div class="form-group">
              <label for="edit-season">Season <span class="required">*</span></label>
              <select id="edit-season" required>
                <option value="">Select Season</option>
                <option value="Halloween">Halloween</option>
                <option value="Christmas">Christmas</option>
                <option value="Shared">Shared</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="edit-class">Class <span class="required">*</span></label>
              <select id="edit-class" required disabled>
                <option value="">Select Class</option>
                <option value="Accessory">Accessory</option>
                <option value="Decoration">Decoration</option>
                <option value="Light">Light</option>
              </select>
              <div class="field-hint">Class cannot be changed</div>
            </div>
            
            <div class="form-group">
              <label for="edit-class-type">Class Type <span class="required">*</span></label>
              <input type="text" id="edit-class-type" readonly disabled>
              <div class="field-hint">Class Type cannot be changed</div>
            </div>
            
            <div class="form-group">
              <label for="edit-status">Status <span class="required">*</span></label>
              <select id="edit-status" required>
                <option value="">Select Status</option>
                <option value="Active">Active</option>
                <option value="Inactive">Inactive</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="edit-general-notes">Item Notes</label>
              <textarea id="edit-general-notes" rows="3"></textarea>
            </div>
          </div>
          
          <!-- Vendor Tab -->
          <div class="tab-content" data-tab="vendor">
            <div class="form-group">
              <label for="edit-store">Store</label>
              <input type="text" id="edit-store">
            </div>
            
            <div class="form-group">
              <label for="edit-manufacturer">Manufacturer</label>
              <input type="text" id="edit-manufacturer">
            </div>
            
            <div class="form-group">
              <label for="edit-cost">Cost</label>
              <input type="text" id="edit-cost" placeholder="e.g., $29.99">
            </div>
            
            <div class="form-group">
              <label for="edit-value">Value</label>
              <input type="text" id="edit-value" placeholder="e.g., $50.00">
            </div>
          </div>
          
          <!-- Storage Tab -->
          <div class="tab-content" data-tab="storage">
            <div class="form-group">
              <label for="edit-tote-location">Storage Location</label>
              <input type="text" id="edit-tote-location" placeholder="e.g., Garage - A3">
            </div>
          </div>
          
          <!-- Misc Tab -->
          <div class="tab-content" data-tab="misc">
            <div id="editMiscFields"></div>
          </div>
        </form>
      </div>
    </div>
    
    <div id="editPreviewView" style="display:none;">
      <div class="modal-body"></div>
    </div>
    
    <div class="modal-footer">
      <button class="btn-secondary" id="editCancelBtn" onclick="closeModal('editModal')">Cancel</button>
      <button class="btn-primary" id="editPreviewBtn" onclick="showEditPreview()">Preview Changes</button>
      <button class="btn-secondary" id="editBackBtn" onclick="backToEditForm()" style="display:none;">Back to Edit</button>
      <button class="btn-primary" id="editSaveBtn" onclick="saveEditChanges()" style="display:none;">Confirm & Save</button>
    </div>
  </div>
</div>

<!-- Create Modal -->
<div id="createModal" class="modal" style="display:none;">
  <div class="panel">
    <div class="modal-header">
      <h2 id="createModalTitle">Create New Item</h2>
      <button class="close-btn" onclick="closeModal('createModal')">&times;</button>
    </div>
    
    <div id="createFormView">
      <!-- Desktop Tabs -->
      <div class="tab-nav">
        <button class="tab-btn active" data-tab="details" onclick="switchCreateTab('details')">Details</button>
        <button class="tab-btn" data-tab="vendor" onclick="switchCreateTab('vendor')">Vendor</button>
        <button class="tab-btn" data-tab="storage" onclick="switchCreateTab('storage')">Storage</button>
      </div>
      
      <!-- Mobile Dropdown -->
      <div class="tab-dropdown-container">
        <select class="tab-dropdown" id="createTabDropdown" onchange="switchCreateTab(this.value)">
          <option value="details">Details</option>
          <option value="vendor">Vendor</option>
          <option value="storage">Storage</option>
        </select>
      </div>
      
      <div class="modal-body">
        <form id="createForm">
          <!-- Details Tab -->
          <div class="tab-content active" data-tab="details">
            <div class="form-group">
              <label for="create-short-name">Name <span class="required">*</span></label>
              <input type="text" id="create-short-name" required>
            </div>
            
            <div class="form-group">
              <label for="create-season">Season <span class="required">*</span></label>
              <select id="create-season" required>
                <option value="">Select Season</option>
                <option value="Halloween">Halloween</option>
                <option value="Christmas">Christmas</option>
                <option value="Shared">Shared</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="create-class">Class <span class="required">*</span></label>
              <select id="create-class" required onchange="onCreateClassChange()">
                <option value="">Select Class</option>
                <option value="Decoration">Decoration</option>
                <option value="Accessory">Accessory</option>
                <option value="Light">Light</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="create-class-type">Class Type <span class="required">*</span></label>
              <select id="create-class-type" required disabled onchange="onCreateClassTypeChange()">
                <option value="">Select Class Type</option>
              </select>
              <div class="field-hint">Select a Class first</div>
            </div>
            
            <div class="form-group">
              <label for="create-status">Status</label>
              <select id="create-status">
                <option value="Active" selected>Active</option>
                <option value="Inactive">Inactive</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="create-deployed">
                <input type="checkbox" id="create-deployed" style="width: auto; margin-right: 8px;">
                Currently Deployed
              </label>
              <div class="field-hint">Check if this item is currently deployed</div>
            </div>
            
            <div class="form-group">
              <label for="create-general-notes">Item Notes</label>
              <textarea id="create-general-notes" rows="3"></textarea>
            </div>
            
            <div id="createDynamicFields">
              <div class="field-hint" style="text-align: center; padding: 20px;">
                Select a Class Type to see additional fields
              </div>
            </div>
          </div>
          
          <!-- Vendor Tab -->
          <div class="tab-content" data-tab="vendor">
            <div class="form-group">
              <label for="create-store">Store</label>
              <input type="text" id="create-store">
            </div>
            
            <div class="form-group">
              <label for="create-manufacturer">Manufacturer</label>
              <input type="text" id="create-manufacturer">
            </div>
            
            <div class="form-group">
              <label for="create-cost">Cost</label>
              <input type="text" id="create-cost" placeholder="e.g., $29.99">
            </div>
            
            <div class="form-group">
              <label for="create-value">Value</label>
              <input type="text" id="create-value" placeholder="e.g., $50.00">
            </div>
          </div>
          
          <!-- Storage Tab -->
          <div class="tab-content" data-tab="storage">
            <div class="form-group">
              <label for="create-tote-location">Storage Location</label>
              <input type="text" id="create-tote-location" placeholder="e.g., Garage - A3">
            </div>
          </div>
        </form>
      </div>
    </div>
    
    <div id="createPreviewView" style="display:none;">
      <div class="modal-body"></div>
    </div>
    
    <div class="modal-footer">
      <button class="btn-secondary" id="createCancelBtn" onclick="closeModal('createModal')">Cancel</button>
      <button class="btn-primary" id="createPreviewBtn" onclick="showCreatePreview()">Preview</button>
      <button class="btn-secondary" id="createBackBtn" onclick="backToCreateForm()" style="display:none;">Back to Edit</button>
      <button class="btn-primary" id="createSaveBtn" onclick="saveNewItem()" style="display:none;">Create Item</button>
    </div>
  </div>
</div>


<!-- Delete Modal -->
<div id="deleteModal" class="modal" style="display:none;">
  <div class="panel">
    <div class="modal-header">
      <h2>Delete Item</h2>
      <button onclick="closeModal('deleteModal')" style="background:transparent;border:none;font-size:20px;cursor:pointer;">&times;</button>
    </div>
    <p>Select items to delete...</p>
    <div class="modal-footer">
      <button class="btn-secondary" onclick="closeModal('deleteModal')">Cancel</button>
      <button class="btn-danger">Delete Selected</button>
    </div>
  </div>
</div>

<!-- JavaScript Modules - Load in order of dependencies -->
<script src="config.js"></script>
<script src="api-service.js"></script>
<script src="ui-renderer.js"></script>
<script src="modal-utils.js"></script>
<script src="view-modal.js"></script>
<script src="edit-modal.js"></script>
<script src="edit-preview.js"></script>
<script src="create-modal.js"></script>
<script src="create-preview.js"></script>
<script src="pagination.js"></script>
<script src="filter-system.js"></script>
<script src="delete-handler.js"></script>
<script src="event-handlers.js"></script>

</body>
</html>