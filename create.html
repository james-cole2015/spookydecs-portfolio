<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Create Item - Admin Dashboard</title>
<style>
  body { font-family: Arial, sans-serif; background-color: #f0f2f5; margin:0; padding:0; display:flex; justify-content:center; min-height:100vh; flex-direction:column; }
  .container { width:100%; max-width:500px; margin:auto; }

  /* Login Form */
  #loginForm { background:#fff; padding:30px; border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,0.1); display:flex; flex-direction:column; gap:10px; margin:auto; }
  #loginForm input { padding:10px; border-radius:4px; border:1px solid #ccc; }
  #loginForm button { padding:10px; border-radius:4px; border:none; background-color:#007bff; color:white; cursor:pointer; }
  #loginForm button:hover { opacity:0.9; }

  /* Create Card */
  #createCard { display:none; background:#fff; padding:30px; border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,0.1); margin:auto; }
  #createCard h2 { text-align:center; margin-bottom:10px; }
  .attribute-name { text-align:center; font-weight:600; margin-bottom:20px; font-size:1.1rem; }
  .field-row { margin-bottom:16px; display:flex; flex-direction:column; }
  .field-label { font-weight:600; margin-bottom:6px; }
  input, select { padding:10px; border-radius:4px; border:1px solid #ccc; width:100%; box-sizing:border-box; }
  button { padding:8px 14px; border:none; border-radius:4px; cursor:pointer; margin-right:8px; }
  button:hover { opacity:0.9; }
  .btn-primary { background-color:#007bff; color:white; }
  .btn-danger { background-color:#dc3545; color:white; }
  .preview { margin-top:12px; text-align:center; }
  .preview img { max-width:320px; height:auto; border-radius:6px; display:block; margin:auto 0; }
  .status { margin-top:12px; font-weight:500; color:#333; text-align:center; }
  footer { text-align:center; padding:12px 0; margin-top:auto; background:#f0f2f5; }
</style>
</head>
<body>
<div class="container">

<!-- Login Form -->
<form id="loginForm">
  <h2>Admin Login</h2>
  <input type="text" id="username" placeholder="Username" required>
  <input type="password" id="password" placeholder="Password" required>
  <button type="submit">Login</button>
  <p id="loginError" style="color:red; text-align:center;"></p>
</form>

<!-- Create Item Card -->
<div id="createCard">
  <h2>Create New Item</h2>
  <div class="attribute-name">Attribute Name</div>

  <div class="field-row">
    <label class="field-label" for="shortName">Short Name</label>
    <input type="text" id="shortName">
  </div>

  <div class="field-row">
    <label class="field-label" for="category">Category</label>
    <select id="category">
      <option value="">Select Category</option>
      <option value="Decorations">Decorations</option>
      <option value="Lighting">Lighting</option>
      <option value="Props">Props</option>
      <option value="Costumes">Costumes</option>
      <option value="Miscellaneous">Miscellaneous</option>
    </select>
  </div>

  <div class="field-row">
    <label class="field-label" for="type">Type</label>
    <select id="type">
      <option value="">Select Type</option>
      <option value="Pumpkin">Pumpkin</option>
      <option value="Skeleton">Skeleton</option>
      <option value="Spider">Spider</option>
      <option value="Ghost">Ghost</option>
      <option value="Lighting">Lighting</option>
      <option value="Other">Other</option>
    </select>
  </div>

  <div class="field-row">
    <label class="field-label" for="imageUpload">Upload Image</label>
    <input type="file" id="imageUpload" accept="image/*" capture="environment">
  </div>

  <div class="preview" id="imagePreview"></div>

  <div style="text-align:center;">
    <button class="btn-primary" id="createBtn">Create</button>
    <button class="btn-danger" id="cancelBtn">Cancel</button>
  </div>

  <div class="status" id="createStatus"></div>
</div>

</div>

<script src="https://cdn.jsdelivr.net/npm/amazon-cognito-identity-js@5.2.7/dist/amazon-cognito-identity.min.js"></script>
<script>
// Cognito & login code unchanged
const poolData = { UserPoolId:'us-east-2_BnxSu5LEt', ClientId:'11er9f8qa7jkvgelm6hernb2ed' };
const userPool = new AmazonCognitoIdentity.CognitoUserPool(poolData);
const loginForm = document.getElementById('loginForm');
const loginError = document.getElementById('loginError');
const createCard = document.getElementById('createCard');
const shortName = document.getElementById('shortName');
const category = document.getElementById('category');
const type = document.getElementById('type');
const imageUpload = document.getElementById('imageUpload');
const imagePreview = document.getElementById('imagePreview');
const createBtn = document.getElementById('createBtn');
const cancelBtn = document.getElementById('cancelBtn');
const createStatus = document.getElementById('createStatus');

window.addEventListener('load', () => {
  const token = localStorage.getItem('jwtToken');
  if(token){
    loginForm.style.display = 'none';
    createCard.style.display = 'block';
  }
});

loginForm.addEventListener('submit', function(event){
  event.preventDefault();
  loginError.textContent = '';
  const username = document.getElementById('username').value;
  const password = document.getElementById('password').value;
  const authenticationDetails = new AmazonCognitoIdentity.AuthenticationDetails({ Username: username, Password: password });
  const userData = { Username: username, Pool: userPool };
  const cognitoUser = new AmazonCognitoIdentity.CognitoUser(userData);
  cognitoUser.authenticateUser(authenticationDetails, {
    onSuccess: (result) => {
      localStorage.setItem('jwtToken', result.getIdToken().getJwtToken());
      loginForm.style.display = 'none';
      createCard.style.display = 'block';
    },
    onFailure: (err) => { loginError.textContent = err.message || JSON.stringify(err); },
    newPasswordRequired: (userAttributes) => {
      delete userAttributes.email_verified;
      const newPassword = prompt("Please enter a new password:");
      cognitoUser.completeNewPasswordChallenge(newPassword, userAttributes, {
        onSuccess: (result) => {
          localStorage.setItem('jwtToken', result.getIdToken().getJwtToken());
          loginForm.style.display = 'none';
          createCard.style.display = 'block';
        },
        onFailure: (err) => { loginError.textContent = err.message || JSON.stringify(err); }
      });
    },
  });
});

imageUpload.addEventListener('change', () => {
  imagePreview.innerHTML = '';
  const file = imageUpload.files[0];
  if(file){
    const img = document.createElement('img');
    img.src = URL.createObjectURL(file);
    imagePreview.appendChild(img);
  }
});

createBtn.addEventListener('click', async () => {
  const jwt = localStorage.getItem('jwtToken');
  if(!jwt){ alert('You must be logged in.'); return; }
  const attrs = { 'Short Name': shortName.value, 'Category': category.value, 'Type': type.value };
  createStatus.textContent = 'Creating item...';
  setTimeout(() => {
    createStatus.textContent = `Item "${attrs['Short Name']}" created successfully!`;
    shortName.value=''; category.value=''; type.value=''; imageUpload.value=''; imagePreview.innerHTML='';
  }, 1000);
});

cancelBtn.addEventListener('click', () => { 
  shortName.value=''; category.value=''; type.value=''; imageUpload.value=''; imagePreview.innerHTML=''; 
  createStatus.textContent=''; 
});
</script>

<footer>Â© 2025 spookydecs.com | Beware the 404s ðŸ‘»</footer>
</body>
</html>
